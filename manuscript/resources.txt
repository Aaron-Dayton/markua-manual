# Resources

### Span Resources


#### Examples

##### Example 1: Span Images with Alt Text

###### Markua Syntax

{#input_span_images_1}
```
Markua has a fancy ![Markua two trees logo](markua-logo-small.png) logo!

Markua also has a fancy ![Markua two trees icon](https://pbs.twimg.com/profile_images/525513829455650817/mIba4bYL_400x400.png) Twitter avatar!
```

###### HTML Output

{#output_span_images_1}
```
<p>Markua has a fancy <img src="resources/markua-logo-small.png" alt="Markua two trees logo"/> logo!</p>
<p>Markua also has a fancy <img src="https://pbs.twimg.com/profile_images/525513829455650817/mIba4bYL_400x400.png" alt="Markua two trees icon"/> Twitter avatar!</p>
```

##### Example 2: Span Images with no Alt Text

Images can be inserted as a span image with no alt text.

###### Markua Syntax

{#input_span_images_2}
```
Markua has a fancy ![](markua-logo-small.png) logo!
```

###### HTML Output

{#output_span_images_2}
```
<p>Markua has a fancy <img src="resources/markua-logo-small.png"/> logo!</p>
```

##### Example 3: Span Images Incorrectly Having a Caption

A span image cannot have a caption. If one is present, it is ignored.

###### Markua Syntax

{#input_span_images_3}
```
Markua has a fancy ![Markua two trees logo](markua-logo-small.png "This caption is ignored") logo!
```

###### HTML Output

{#output_span_images_3}
```
<p>Markua has a fancy <img src="resources/markua-logo-small.png" alt="Markua two trees logo"/> logo!</p>
```

{#figures}
### Figures

#### Examples

##### Example 1: Figures with Alt Text and a Caption

Ideally, a figure should have both alt text and a caption. The alt text is intended for readers who can't see the image, and the caption is intended to complement the image.

###### Markua Syntax

{#input_figures_1}
```
Markua has a fancy logo:

![the word Markua with the two asterisk trees beside it](markua-logo.png "The Markua Logo")

Markua also has a fancy Twitter avatar:

![Markua two trees icon](https://pbs.twimg.com/profile_images/525513829455650817/mIba4bYL_400x400.png "The Markua Icon")

Thanks Justin, it was fun making the logo with you!
```

###### HTML Output

{#output_figures_1}
```
<p>Markua has a fancy logo:</p>
<div class="figure">
  <img src="media/markua-logo.png" alt="the word Markua with the two asterisk trees beside it"/>
  <p class="caption">The Markua Logo</p>
</div>
<p>Markua also has a fancy Twitter avatar:</p>
<div class="figure">
  <img src="https://pbs.twimg.com/profile_images/525513829455650817/mIba4bYL_400x400.png" alt="Markua two trees icon"/>
  <p class="caption">The Markua Icon</p>
</div>
<p>Thanks Justin, it was fun making the logo with you!</p>
```

##### Example 2: Figures with no Alt Text or Caption

Images can be inserted as a figure even with no alt text or caption. If this is done, the image is still styled as a figure, but the image has no caption and does **not** show up in the List of Illustrations.

###### Markua Syntax

{#input_figures_2}
```
Markua has a fancy logo:

![](markua-logo.png)

Thanks Justin, it was fun making the logo with you!
```

###### HTML Output

{#output_figures_2}
```
<p>Markua has a fancy logo:</p>
<div class='figure'>
  <img src="media/markua-logo.png"/>
</div>
<p>Thanks Justin, it was fun making the logo with you!</p>
```

##### Example 3: Figures with Alt Text but no Caption

The alt text and caption are both optional. This example shows a figure with alt text but no caption.

###### Markua Syntax

{#input_figures_3}
```
Markua has a fancy logo:

![the word Markua with the two asterisk trees beside it](markua-logo.png)

Thanks Justin, it was fun making the logo with you!
```

###### HTML Output

{#output_figures_3}
```
<p>Markua has a fancy logo:</p>
<div class="figure">
  <img src="media/markua-logo.png" alt="the word Markua with the two asterisk trees beside it"/>
</div>
<p>Thanks Justin, it was fun making the logo with you!</p>
```

##### Example 4: Figures with a Caption but no Alt Text

The alt text and caption are both optional. This example shows a figure with a caption but no alt text.

###### Markua Syntax

{#input_figures_4}
```
Markua has a fancy logo:

![](markua-logo.png "The Markua Logo")

Thanks Justin, it was fun making the logo with you!
```

###### HTML Output

{#output_figures_4}
```
<p>Markua has a fancy logo:</p>
<div class="figure">
  <img src="media/markua-logo.png"/>
  <p class="caption">The Markua Logo</p>
</div>
<p>Thanks Justin, it was fun making the logo with you!</p>
```

##### Example 5: A Figure with `float` Attribute and a Percentage `width` Attribute

This example shows a figure which is floated `left` and which has a `width` of half the print area on the page.

###### Markua Syntax

{#input_figures_5}
```
Markua has a fancy logo:

{float: "left", width: "50%"}
![the word Markua with the two asterisk trees beside it](markua-logo.png "The Markua Logo")

Thanks Justin, it was fun making the logo with you!
```

###### HTML Output

{#output_figures_5}
```
<p>Markua has a fancy logo:</p>
<div class="figure">
  <img src="markua-logo.png" style="float: left; width: 50%;" alt="the word Markua with the two asterisk trees beside it"/>
  <p class="caption">The Markua Logo</p>
</div>
<p>Thanks Justin, it was fun making the logo with you!</p>
```

##### Example 6: A Figure with a `width` Attribute of `fullbleed`

This example shows a figure which has a `width` attribute of `fullbleed`. Note that this sets a `class` of `fullbleed` and an inline style `width` of `100%`.

###### Markua Syntax

{#input_figures_6}
```
Markua has a fancy logo:

{width: "fullbleed"}
![the word Markua with the two asterisk trees beside it](markua-logo.png "The Markua Logo")

Thanks Justin, it was fun making the logo with you!
```

###### HTML Output

{#output_figures_6}
```
<p>Markua has a fancy logo:</p>
<div class="figure">
  <img src="markua-logo.png" class="fullbleed" style="width: 100%;" alt="the word Markua with the two asterisk trees beside it"/>
  <p class="caption">The Markua Logo</p>
</div>
<p>Thanks Justin, it was fun making the logo with you!</p>
```

## Resource Type: `image`, `video`, `audio`, `code`, `math` and `text`

Markua supports six types of resources, which are determined by the value of the `type` attribute.

The legal values of the `type` attribute are: `image`, `video`, `audio`, `code`, `math` and `text`.

For images, video and audio, Markua Processors rely on the file extension to determine the specific type of resource.

## Image Resources

Markua supports GIF, PNG, JPEG and SVG images. The images must have the correct file extension for their type. Markua processors do not need to parse images to determine their type.

The supported file extensions for images are:

.gif
: The file is treated as a GIF image.

.jpg
: The file is treated as a JPEG image.

.jpeg
: The file is treated as a JPEG image.

.png
: The file is treated as a PNG image.

.svg
: The image is treated as an SVG image.

.svgz
: The image is treated as an SVG image which has been zipped.

.xml
: The image is treated as an SVG image.

## Video Resources

Markua supports MP4 and WebM videos. The videos must have the correct file extension for their type.

The supported file extensions for video files are:

.mp4
: The file is treated as an MP4 video.

.webm
: The file is treated as a WebM image.

A> For those familiar with HTML5 video: the `mediagroup` syntax and/or the use of `source` elements is not currently supported in Markua. A syntax for producing these may be added in future Markua versions.

If a Markua Processor is outputting a format in which particular types of audio or video resources are not supported, a missing audio or video image placeholder must be output. The look of this missing audio or video image is not specified in Markua; it can either be deliberately ugly (like the missing image icon in web browsers circa 1995) or it can be attractive.

If a Markua Processor is outputting a print book or some format where it is known that video resources are not supported, it must choose the poster to use as an image replacement. (This includes situations where the video is identified by a URL and only local video resources are supported by the particular Markua Processor.)

## Audio Resources

Markua supports MP3, AAC, Ogg and WAV audio files.

The supported file extensions for audio files are:

.mp3
: The file is treated as MP3 audio.

.m4a, .aac
: The file is treated as an MP4 AAC (Advanced Audio Coding) audio file. Note that .mp4 is not supported as a file extension for MP4 AAC audio, since that is the file extension used for MP4 video.

.wav, .wave
: The file is treated as a WAV (Waveform Audio File Format) file.

.ogg, .oga
: The file is treated as an Ogg Vorbis file.

{#code_resources}
## Code Resources

{#codespans}
### Code Spans

Code like `hello world` can be inserted using backticks inside a paragraph, heading, or any other block element.

#### Example

{#input_code_span_1}
##### Markua Syntax

```
Here is some `hello world` span code.
```

{#output_code_span_1}
##### HTML Output

```
<p>Here is some <code>hello world</code> span code.</p>
```

### Two Backticks to Enclose One Backtick

Just as with Markdown, to show a literal backtick, you use *two* backticks to start and end your code span. (The Markdown spec says multiple backticks; Markua says exactly two.)

Note that like Markdon, any leading or trailing spaces in a code span are removed.

#### Example

{#input_code_span_2}
##### Markua Syntax

```
Here is some ``code with a backtick (`) in it`` and other text.

If you want to have a backtick by itself, just use you need to have spaces around it like this `` ` ``. The enclosed backtick cannot start or end the code block.
```

{#output_code_span_2}
##### HTML Output

```
<p>Here is some <code>code with a backtick (`) in it</code> and other text.</p>
<p>If you want to have a backtick by itself, just use you need to have spaces around it like this <code>`</code>. The enclosed backtick cannot start or end the code block.</p>
```

### Code Blocks

Code blocks can be defined inline or can import external code samples. Many attributes work the same way in both cases. The inline code block approach will be shown first.

{class: warning}
B> TODO - reference attribute list thing here, need to have a list of every element and attribute in appendix etc etc

#### Inline Code Blocks in Markua Text

You can create an inline code block by surrounding it using three backticks (`\``).

(You can also create an inline code block by surrounding it with three tildes (`~~~`), but the only reason this alternative exists is to enable writing about Markua code blocks that are surrounded with backticks in Markua. The correct approach in normal cases is to use three backticks.)

Here's an example of a code block:

~~~
```
def foo
  2
end
```
~~~

W> The "four space indent" method of creating code blocks in Markdown is not supported in Markua.

Since we force a blank line to end a list and since we force delimiters at the beginning of each list item, there's no reason to indent anything to make it part of the list item. It is part of the list item unless the list is over. Code blocks and multiple paragraphs can be added in single list item by newlines.

Markua also supports defining the language that a code sample is written in using the GitHub Flavoured Markdown style language specification, in which the language name is added after the three opening backticks that start a code block:

~~~
```ruby
def foo
  2
end
```
~~~

Markua Processors may guess at the language of a code block. To explicitly turn this off for a give code block, it can be forced to be plain text like this:

~~~
```text
def foo
  2
end
```
~~~

If a Markua Processor knows how to format the code using the specified language (if it has a "lexer" for it), it can do so. Otherwise, it must format the code using plain text as though `text` was specified as the language.

Note that this language definition is just a shorthand for a more general metadata feature of markua called attributes. Briefly, attributes comma-separated key-value pairs enclosed in a pair of curly braces (`{` ... `}`) and separated by a newline but **not** by a blank line from the thing that they are an attribute of.

You can define the language of a code block explicitly using the language attribute:

~~~
{language: ruby}
```
def foo
  2
end
```
~~~

Markua also supports adding other information to attributes of code blocks. For example, you can explicitly turn line numbering on an off using the `line-numbers` attribute:

~~~
{language: ruby, line-numbers: off}
```
def foo
  2
end
```
~~~

You can mix-and-match the attribute syntax and the GitHub-style syntax. The following is legal in Markua:

~~~
{line-numbers: on}
```ruby
def foo
  2
end
```
~~~

If the attribute and the GitHub-style syntax conflict, the attribute wins. The following will be formatted as plain text, not ruby:

~~~
{language: text, line-numbers: on, number-from: 3}
```ruby
def foo
  2
end
```
~~~

A> Line Wrapping
A>
A> Code blocks should have newlines added by the author to ensure that automatic line wrapping is not relied upon. Markua Processors must wrap lines to ensure that all code is visible, and *may* add continuation characters (like the backslash `\` character) in the output to indicate that a line has been automatically wrapped. However, adding a continuation character is not a requirement.

#### ASCII art

{class: warning}
B> TODO: possibly support {language: `asciiart`} on a code block, which tightens line spacing and turns off page breaks so that ASCII art looks better.

### Importing Code Samples from External Files

To import a code sample from an external file, you use a syntax very similar to the image insertion syntax:

```
<<(sample1.rb)
```

All external code samples must live inside the code subdirectory or one of its subdirectories.

A> In Leanpub Flavoured Markdown, the paths included `code/`. This was redundant, since all code had to live in the code directory. So, Markua omits `code/` from the path.

External code samples can also have attributes added to them on import. These can set a caption, determine what subset of the code example to show, as well as set the line number to start the numbering on.

The following will show a code sample with the caption of "My Brilliant Algorithm". The code sample will contain 6 lines (lines 10-15 inclusive), and it will number them 10, 11, 12, 13, 14 and 15 since those are the line numbers of the given lines in the file:

```
{caption: "My Brilliant Algorithm", language: ruby, crop-start: 10, crop-end: 15, line-numbers: on}
<<(sample1.rb)
```

If this is not desired, you can choose to start the numbering wherever you want with `number-from`. Choosing `1` is a good choice.

The following will show 6 lines (lines 10-15 inclusive), and it will number them 1, 2, 3, 4, 5 and 6:

```
{language: ruby, crop-start: 10, crop-end: 15, line-numbers: on, number-from: 1}
<<(sample1.rb)
```

Or, if you wish to make things annoying, you can number from any non-negative integer you want. The following will show 6 lines (lines 10-15 inclusive), and it will number them 3, 4, 5, 6, 7 and 8:

```
{language: ruby, crop-start: 10, crop-end: 15, line-numbers: on, number-from: 3}
<<(sample1.rb)
```

A> The Leanpub Flavoured Markdown syntax of putting a code sample caption is not supported. This syntax looked like the alt text on images, but as discussed there, this was an incorrecct use of the image syntax.

## Math Resources

You can put mathematical equations in your book, in either block elements (described below) or in span elements.

W> TODO: RESOURCE INSERTION REWRITE

### Math Spans: Verbose and \{$$}

Math can be inserted as span elements as well as as a block element.

To do this, there's a verbose syntax and a syntactic sugar syntax.

The verbose syntax:

```
blah blah {type: math, language: mathml}here's your math{/} blah blah

blah blah {type: math, language: latex}math here too!{/} blah blah
```

Note that since these are span elements, LaTeX math will look a lot better than MathML.

Also, this is very verbose. So, this is also supported:

```
blah blah {$$}math here too!{/$$} blah blah
```

This uses the default math engine. Chances are if you're using this syntax, you're using LaTeX math.

Here's a longer example:

#### Markua Syntax

```
The four kinematics equations are {$$}d = v_i t + \frac{1}{2} a t^2{/$$}, {$$}v_f^2 = v_i^2 + 2 a d{/$$}, {$$}v_f = v_i + a t{/$$} and {$$}d = \frac{1}{2}(v_i + v_f) t{/$$}.
```

#### HTML Output

Markua processors can do whatever they want here as well.

### Math Blocks

To create a math block, you insert it like a code block and you add a `math` attribute. The key is `math` and the value can either be `latex`, `mathml` or some other term.  This value specifies the markup language of the Math block.

**Markua procesors do NOT need to support any given Math markup language.**

However, if a Markua processor does not understand a given Math markup language specified by the value of a `math` attribute (say, if it supports LaTeX math but not MathML), it **MUST** output the content of the math block **as a code block formatted as text**.

#### LaTeX Math with `{type: math, language: latex}`

To add LaTeX math, use `{type: math, language: latex}`:

##### Markua Syntax

~~~
Here is some paragraph text.

{type: math, language: latex}
```
\left|\sum_{i=1}^n a_ib_i\right|
\le
\left(\sum_{i=1}^n a_i^2\right)^{1/2}
\left(\sum_{i=1}^n b_i^2\right)^{1/2}
```

Here is some more paragraph text.
~~~

#### HTML Output

Markua processors can do whatever they want here. They can even output the entire thing as an image and insert the image, since that works on the most legacy ebook readers. Accessibility for old devices and accessibility for people with visual disabilities are often in conflict, and it's up to the Markua Processor to decide what to do.

### MathML Math with `{math: mathml}`

To add MathML math, use `{math: mathml}`:

A> MathML is not supported in Leanpub, so we have no idea if supporting it is a good idea or not.

#### Markua Syntax

~~~
Here's an example from [Wikipedia](http://en.wikipedia.org/wiki/MathML):

{type: math, language: mathml}
```
<apply>
  <plus/>
  <apply>
    <times/>
    <ci>a</ci>
    <apply>
      <power/>
      <ci>x</ci>
      <cn>2</cn>
    </apply>
  </apply>
  <apply>
    <times/>
    <ci>b</ci>
    <ci>x</ci>
  </apply>
  <ci>c</ci>
</apply>
```

Here is some more paragraph text.
~~~

#### HTML Output

Markua processors can do whatever they want here as well.

### Math Blocks with Default `math`

Note that there is a default markup language for math in a Markua document. It is determined by the value of the `math` attribute which is set in the metadata. The default value of the `math` attribute is `latex`.

Because of this, you can also insert math like this:

#### Markua Syntax

~~~
Here is some paragraph text.

```math
\left|\sum_{i=1}^n a_ib_i\right|
\le
\left(\sum_{i=1}^n a_i^2\right)^{1/2}
\left(\sum_{i=1}^n b_i^2\right)^{1/2}
```

Here is some more paragraph text.
~~~

#### HTML Output

Markua processors can do whatever they want here as well.

## Text Resources

TODO - explain this, and include custom types of text resources

A> For the programmers reading this: since resources cannot themselves include resources, you cannot have cycles resulting in infinitely long Markua documents.